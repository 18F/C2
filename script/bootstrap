#!/bin/sh

set -e
set -x

# create config files, if not already present
if [ ! -f config/database.yml ]; then
  cp config/database.yml.example config/database.yml
fi
if [ ! -f config/environment_variables.yml ]; then
  cp config/environment_variables.yml.example config/environment_variables.yml
fi

# http://docs.travis-ci.com/user/caching/#Bundler
if [ "$CI" -ne "true" ]; then
  bundle
fi

npm install -g grunt-cli
npm install

bundle exec rake db:setup
bundle exec rake db:test:prepare

echo "DONE"
