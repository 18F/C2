- t_slug = "decorators." + @current_user.client_slug + "/work_order."
- client_slug = @current_user.client_slug
- client_data = @client_data_instance
- client_id = client_data.id.to_s
= simple_form_for client_data, html: { multipart: true }, remote: true do |f|
  - i = 0
  - @proposal.new_fields_for_display.each do |field|
    - key = field[:key]
    - value_id = key + '-' + client_id
    - if i == 1
      :plain
        <div class="medium-up-2">

    - if key == 'expense_type'
      = render partial: client_slug + "/fields/" + key, locals: { f: f, key: key, proposal: @proposal, client_data: client_data }
    
    - elsif key == 'not_to_exceed' # See 'amount'
    - elsif key == 'amount'
        
      .column{ id: key + '-wrapper'}
        .detail-wrapper.row{ class: "amount" + "-wrapper"}
          .detail-display.column
            .row
              .medium-3.column
                %label.detail-element
                  = t(t_slug + "total") 
              .medium-9.column
                %span.detail-value{class: "not_to_exceed", id: "not_to_exceed" + '-' + client_id }
                  - if client_data[:not_to_exceed]
                    Not to exceed
                %span.detail-value{class: "amount", id: "amount" + '-' + client_id }
                  %strong
                    = "$" + client_data[:amount].to_s
          .detail-edit.column
            %label.detail-element
              = t(t_slug + "amount") 
            %span.detail-value
              = render partial: client_slug + "/fields/" + "amount", locals: { f: f, proposal: @proposal, client_data: client_data }

    - else
      .column{ id: key + '-wrapper'}
        .detail-wrapper.row{ class: key + "-wrapper"}
          .detail-display.column
            %label.detail-element
              = t(t_slug + key) 
            %span.detail-value{id: value_id }
              = client_data[key]
          .detail-edit.column
            %label.detail-element
              = t(t_slug + key) 
            %span.detail-value
              = render partial: field[:partial], locals: { f: f, proposal: @proposal, client_data: client_data }
    - i = i + 1
  :plain
    </div>

  = submit_tag "Submit", hidden: true
