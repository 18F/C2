- # Requires the "container" variable
%table.tabular-data
  %thead
    - # @todo: "header" class shouldn't be required (we're in thead)
    %tr.header
      - container.columns.each do |column|
        %th{class: column.sort_dir}
          - # @todo: why are there h5s in our table headers?
          %h5
            - if !container.frozen_sort && column.can_sort?
              - # long-form instead of link_to to avoid brakeman XSS warning
              %a{href: "?#{container.sort_params(request.query_parameters, column).to_query}"}
                = column.header
            - else
              = column.header
  %tbody
    - container.rows.each do |row|
      %tr
        - container.columns.each do |column|
          %td
            - formatter_tpl = "shared/formatter/" + column.formatter.to_s
            - value = column.display(row)
            = render partial: formatter_tpl, locals: {object: row, value: value}
